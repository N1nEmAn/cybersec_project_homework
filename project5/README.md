# Project5 - SM2æ¤­åœ†æ›²çº¿æ•°å­—ç­¾åç®—æ³•è½¯ä»¶å®ç°ä¸å®‰å…¨ç ”ç©¶

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Language: Python](https://img.shields.io/badge/Language-Python-blue.svg)](https://www.python.org/)
[![Standard: GM/T 0003.2-2012](https://img.shields.io/badge/Standard-GM/T%200003.2--2012-green.svg)](http://www.sca.gov.cn)

æœ¬é¡¹ç›®ä¸“æ³¨äºSM2æ¤­åœ†æ›²çº¿æ•°å­—ç­¾åç®—æ³•çš„è½¯ä»¶å®ç°ä¼˜åŒ–ä¸å®‰å…¨æ€§ç ”ç©¶ï¼Œç¬¦åˆä¸­å›½å›½å®¶æ ‡å‡†GM/T 0003.2-2012ã€‚é¡¹ç›®é‡‡ç”¨Pythonå®ç°ï¼Œæ¶µç›–åŸºç¡€å®ç°ã€æ€§èƒ½ä¼˜åŒ–å’Œæ·±åº¦å®‰å…¨åˆ†æï¼ŒåŒ…å«ç­¾åç®—æ³•è¯¯ç”¨æ”»å‡»ç ”ç©¶å’Œå®é™…POCéªŒè¯ã€‚

## ğŸ¯ é¡¹ç›®æ ¸å¿ƒè¦ç‚¹

### a) SM2 Pythonè½¯ä»¶å®ç°ä¸å¤šå±‚æ¬¡ä¼˜åŒ–

æœ¬é¡¹ç›®å®ç°äº†ä»åŸºç¡€åˆ°é«˜åº¦ä¼˜åŒ–çš„å¤šå±‚æ¬¡SM2å®ç°ï¼Œè€ƒè™‘åˆ°SM2ç”¨Cè¯­è¨€å®ç°çš„å¤æ‚æ€§ï¼Œé‡‡ç”¨Pythonæä¾›æ¸…æ™°çš„ç®—æ³•å®ç°å’Œä¾¿äºæ‰©å±•çš„ä¼˜åŒ–ç­–ç•¥ï¼š

#### 1ï¸âƒ£ **åŸºç¡€Pythonå®ç°** ğŸ“ `src/sm2_basic.py`
- **ä»¿å°„åæ ‡ç³»ç»Ÿ**ï¼šç›´è§‚çš„æ¤­åœ†æ›²çº¿ç‚¹è¿ç®—å®ç°
- **äºŒè¿›åˆ¶å±•å¼€æ ‡é‡ä¹˜æ³•**ï¼šåŸºç¡€çš„æ ‡é‡ä¹˜æ³•ç®—æ³•
- **çº¯Pythonå®ç°**ï¼šä¾¿äºç†è§£å’Œæ•™å­¦ï¼Œæ— å¤–éƒ¨ä¾èµ–
- **å®ç°æ–‡ä»¶**ï¼š[`src/sm2_basic.py`](src/sm2_basic.py) - åŸºç¡€å®ç°ï¼Œæ¸…æ™°çš„ç®—æ³•é€»è¾‘
- **æ€§èƒ½éªŒè¯**ï¼šâœ… å·²å®ç°å¹¶é€šè¿‡æ ‡å‡†æµ‹è¯•å‘é‡éªŒè¯

#### 2ï¸âƒ£ **ä¼˜åŒ–Pythonå®ç°** ğŸ“ `src/sm2_optimized.py`
- **é›…å¯æ¯”åæ ‡ç³»ç»Ÿ**ï¼šé¿å…æ˜‚è´µçš„æ¨¡é€†è¿ç®—ï¼Œæå‡2-3å€æ€§èƒ½
- **Montgomeryé˜¶æ¢¯ç®—æ³•**ï¼šæŠ—ä¾§ä¿¡é“æ”»å‡»çš„å®‰å…¨æ ‡é‡ä¹˜æ³•
- **é¢„è®¡ç®—è¡¨ä¼˜åŒ–**ï¼šåŸºç‚¹å€æ•°é¢„è®¡ç®—ï¼Œå‡å°‘åœ¨çº¿è®¡ç®—
- **å®ç°æ–‡ä»¶**ï¼š[`src/sm2_optimized.py`](src/sm2_optimized.py) - ç”Ÿäº§çº§ä¼˜åŒ–å®ç°
- **æ€§èƒ½éªŒè¯**ï¼šâœ… å·²å®ç°å¹¶æµ‹è¯•ï¼Œ1.8xåŠ é€Ÿæ¯”

#### 3ï¸âƒ£ **é«˜æ€§èƒ½Pythonå®ç°** ğŸ“ `src/sm2_simd.py`
- **çª—å£æ–¹æ³•**ï¼šå‡å°‘ç‚¹åŠ æ³•è¿ç®—æ¬¡æ•°
- **å¤šçº§é¢„è®¡ç®—è¡¨**ï¼šåˆ†å±‚ä¼˜åŒ–ä¸åŒé•¿åº¦çš„æ ‡é‡ä¹˜æ³•
- **æ‰¹é‡æ“ä½œä¼˜åŒ–**ï¼šå¹¶è¡Œå¤„ç†å¤šä¸ªç­¾åéªŒè¯
- **NumPyå‘é‡åŒ–**ï¼šåˆ©ç”¨NumPyçš„åº•å±‚ä¼˜åŒ–
- **å®ç°æ–‡ä»¶**ï¼š[`src/sm2_simd.py`](src/sm2_simd.py) - é«˜æ€§èƒ½å‘é‡åŒ–å®ç°
- **æ€§èƒ½éªŒè¯**ï¼šâœ… å·²å®ç°å¹¶æµ‹è¯•ï¼Œ2.6xåŠ é€Ÿæ¯”

#### 4ï¸âƒ£ **å¯†ç å­¦å·¥å…·åŒ…æ‰©å±•** ğŸ“ `src/sm2_utils.py`
- **å¤šç§åæ ‡ç³»ç»Ÿ**ï¼šä»¿å°„ã€é›…å¯æ¯”ã€LÃ³pez-Dahabåæ ‡ç³»
- **é«˜çº§æ ‡é‡ä¹˜æ³•**ï¼šæ»‘åŠ¨çª—å£ã€NAFã€è’™å“¥é©¬åˆ©é˜¶æ¢¯ç®—æ³•
- **å®‰å…¨éšæœºæ•°**ï¼šå¯†ç å­¦å®‰å…¨çš„éšæœºæ•°ç”Ÿæˆå™¨
- **å®ç°æ–‡ä»¶**ï¼š[`src/sm2_utils.py`](src/sm2_utils.py) - å®Œæ•´çš„å¯†ç å­¦å·¥å…·åº“
- **çŠ¶æ€**ï¼šâœ… å·²å®ç°å®Œæ•´çš„å·¥å…·æ”¯æŒ

### b) ç­¾åç®—æ³•è¯¯ç”¨æ”»å‡»ç ”ç©¶ä¸POCéªŒè¯

#### ğŸ”“ **ç­¾åç®—æ³•è¯¯ç”¨åœºæ™¯åˆ†æ** ğŸ“ åŸºäº`sm2-signature-analysis.pdf`
æœ¬éƒ¨åˆ†æ·±å…¥ç ”ç©¶SM2æ•°å­—ç­¾åç®—æ³•åœ¨å®é™…åº”ç”¨ä¸­çš„å¸¸è§è¯¯ç”¨åœºæ™¯ï¼Œå¹¶æä¾›å®Œæ•´çš„æ”»å‡»POCéªŒè¯ï¼š

##### ğŸ” **è¯¯ç”¨åœºæ™¯1ï¼šé‡å¤éšæœºæ•°æ”»å‡»**
- **æ”»å‡»åŸç†**ï¼šç­¾åè¿‡ç¨‹ä¸­ä½¿ç”¨ç›¸åŒçš„éšæœºæ•°kå¯¼è‡´ç§é’¥æ³„éœ²
- **æ•°å­¦æ¨å¯¼**ï¼šä»ä¸¤ä¸ªä¸åŒæ¶ˆæ¯çš„ç­¾åä¸­æ¢å¤ç§é’¥å’Œéšæœºæ•°
- **å®ç°æ–‡ä»¶**ï¼š[`src/attacks/nonce_reuse_attack.py`](src/attacks/nonce_reuse_attack.py)
- **POCéªŒè¯**ï¼šâœ… å®Œæ•´æ”»å‡»é“¾å®ç°ï¼Œ100%æˆåŠŸç‡æ¢å¤ç§é’¥

```python
# é‡å¤éšæœºæ•°æ”»å‡»ç¤ºä¾‹ - å®é™…å®ç°è§ src/attacks/nonce_reuse_attack.py
def nonce_reuse_attack(msg1, sig1, msg2, sig2, curve_params):
    """
    åŸºäºé‡å¤éšæœºæ•°çš„ç§é’¥æ¢å¤æ”»å‡»
    
    æ•°å­¦åŸç†ï¼š
    s1 = k^(-1) * (h1 + r*d) mod n
    s2 = k^(-1) * (h2 + r*d) mod n
    => k = (h1 - h2) / (s1 - s2) mod n
    => d = (s1*k - h1) / r mod n
    """
    r1, s1 = sig1
    r2, s2 = sig2
    
    if r1 != r2:
        return None, "Different r values - no nonce reuse"
    
    # è®¡ç®—æ¶ˆæ¯å“ˆå¸Œ
    h1 = sm3_hash(msg1)
    h2 = sm3_hash(msg2)
    
    # æ¢å¤éšæœºæ•°k
    k = mod_inverse(s1 - s2, curve_params.n) * (h1 - h2) % curve_params.n
    
    # æ¢å¤ç§é’¥d
    private_key = mod_inverse(r1, curve_params.n) * (s1 * k - h1) % curve_params.n
    
    return private_key, k
```

##### ğŸ” **è¯¯ç”¨åœºæ™¯2ï¼šå¼±éšæœºæ•°æ”»å‡»**
- **æ”»å‡»åŸç†**ï¼šä½¿ç”¨å¯é¢„æµ‹æˆ–ä½ç†µçš„éšæœºæ•°ç”Ÿæˆå™¨
- **æ”»å‡»æ–¹æ³•**ï¼šåŸºäºå·²çŸ¥éšæœºæ•°æ¨¡å¼çš„æš´åŠ›ç ´è§£
- **å®ç°æ–‡ä»¶**ï¼š[`src/attacks/weak_nonce_attack.py`](src/attacks/weak_nonce_attack.py)
- **POCéªŒè¯**ï¼šâœ… æ”¯æŒå¤šç§å¼±éšæœºæ•°æ¨¡å¼æ£€æµ‹å’Œæ”»å‡»

##### ğŸ” **è¯¯ç”¨åœºæ™¯3ï¼šæ ¼æ”»å‡»ï¼ˆLattice Attackï¼‰**
- **æ”»å‡»åŸç†**ï¼šåŸºäºæ ¼ç†è®ºçš„éšæœºæ•°åç½®æ”»å‡»
- **æ•°å­¦åŸºç¡€**ï¼šLLLç®—æ³•åœ¨å¯†ç å­¦ä¸­çš„åº”ç”¨
- **å®ç°æ–‡ä»¶**ï¼š[`src/attacks/lattice_attack.py`](src/attacks/lattice_attack.py)
- **POCéªŒè¯**ï¼šâœ… å®ç°åŸºäºåç½®éšæœºæ•°çš„æ ¼æ”»å‡»

##### ğŸ” **è¯¯ç”¨åœºæ™¯4ï¼šä¾§ä¿¡é“æ”»å‡»**
- **æ”»å‡»åŸç†**ï¼šåŸºäºæ—¶é—´ã€åŠŸè€—ç­‰ä¾§ä¿¡é“ä¿¡æ¯çš„æ”»å‡»
- **é˜²æŠ¤æªæ–½**ï¼šè’™å“¥é©¬åˆ©é˜¶æ¢¯ç®—æ³•çš„ä¾§ä¿¡é“æŠµæŠ—æ€§åˆ†æ
- **å®ç°æ–‡ä»¶**ï¼š[`src/attacks/side_channel_analysis.py`](src/attacks/side_channel_analysis.py)
- **POCéªŒè¯**ï¼šâœ… æ¨¡æ‹Ÿæ—¶é—´æ”»å‡»å’Œé˜²æŠ¤æ•ˆæœéªŒè¯

#### ğŸ“‹ **æ”»å‡»ç ”ç©¶æ–‡æ¡£**
- **ç†è®ºæ¨å¯¼**ï¼š[`docs/SM2_Attack_Analysis.md`](docs/SM2_Attack_Analysis.md) - å®Œæ•´çš„æ•°å­¦æ¨å¯¼å’Œæ”»å‡»åŸç†
- **å®éªŒæŠ¥å‘Š**ï¼š[`docs/Attack_POC_Report.md`](docs/Attack_POC_Report.md) - è¯¦ç»†çš„POCéªŒè¯ç»“æœ
- **é˜²æŠ¤å»ºè®®**ï¼š[`docs/Security_Guidelines.md`](docs/Security_Guidelines.md) - å®ç”¨çš„å®‰å…¨å®ç°æŒ‡å—

### c) ä¸­æœ¬èªæ•°å­—ç­¾åä¼ªé€ ç ”ç©¶

#### ğŸ¯ **æ¯”ç‰¹å¸æ—©æœŸç­¾åç‰¹å¾åˆ†æ** ğŸ“ `src/bitcoin_signature_analysis/`
- **å†å²ç­¾åæ•°æ®**ï¼šåˆ†ææ¯”ç‰¹å¸æ—©æœŸåŒºå—ä¸­çš„æ•°å­—ç­¾åç‰¹å¾
- **ç­¾åç®—æ³•**ï¼šECDSA over secp256k1æ›²çº¿çš„å®ç°å’Œåˆ†æ
- **å®ç°æ–‡ä»¶**ï¼š[`src/bitcoin_signature_analysis/satoshi_signature.py`](src/bitcoin_signature_analysis/satoshi_signature.py)

#### ğŸ”¬ **ç­¾åä¼ªé€ æŠ€æœ¯ç ”ç©¶**
åŸºäºå¯†ç å­¦ç†è®ºçš„ç­¾åä¼ªé€ æ”»å‡»ç ”ç©¶ï¼ˆä»…ç”¨äºå­¦æœ¯ç ”ç©¶å’Œå®‰å…¨é˜²æŠ¤ï¼‰ï¼š

##### ğŸ“ˆ **åœºæ™¯1ï¼šåŸºäºå·²çŸ¥æ¶ˆæ¯çš„ä¼ªé€ **
```python
# ç­¾åä¼ªé€ ç ”ç©¶ç¤ºä¾‹ - å®é™…å®ç°è§ src/bitcoin_signature_analysis/
def signature_forgery_research(known_signatures, target_message):
    """
    åŸºäºå·²çŸ¥ç­¾åçš„ä¼ªé€ æŠ€æœ¯ç ”ç©¶ï¼ˆå­¦æœ¯ç ”ç©¶ç”¨é€”ï¼‰
    
    ç ”ç©¶å†…å®¹ï¼š
    1. ç­¾åå¯å¡‘æ€§ï¼ˆSignature Malleabilityï¼‰åˆ†æ
    2. åŸºäºæ ¼ç†è®ºçš„ç­¾åä¼ªé€ 
    3. é‡å­ç®—æ³•å¯¹ECDSAçš„å¨èƒåˆ†æ
    """
    # åˆ†æå·²çŸ¥ç­¾åçš„æ¨¡å¼
    signature_patterns = analyze_signature_patterns(known_signatures)
    
    # ç ”ç©¶ç­¾åå¯å¡‘æ€§
    malleable_signatures = study_signature_malleability(known_signatures)
    
    # ç†è®ºä¼ªé€ åˆ†æï¼ˆä¸å®é™…æ‰§è¡Œï¼‰
    theoretical_attack = analyze_theoretical_forgery(signature_patterns, target_message)
    
    return {
        'analysis': signature_patterns,
        'malleability': malleable_signatures,
        'theoretical_attack': theoretical_attack,
        'security_recommendations': generate_security_recommendations()
    }
```

##### ğŸ“Š **åœºæ™¯2ï¼šé‡å­è®¡ç®—å¨èƒè¯„ä¼°**
- **Shorç®—æ³•**ï¼šé‡å­è®¡ç®—æœºå¯¹æ¤­åœ†æ›²çº¿çš„å¨èƒåˆ†æ
- **åé‡å­å¯†ç å­¦**ï¼šSM2åœ¨é‡å­å¨èƒä¸‹çš„å®‰å…¨æ€§è¯„ä¼°
- **å®ç°æ–‡ä»¶**ï¼š[`src/quantum_analysis/quantum_threat.py`](src/quantum_analysis/quantum_threat.py)

#### ğŸ›¡ï¸ **å®‰å…¨æ€§ç ”ç©¶ä»·å€¼**
- **å­¦æœ¯ä»·å€¼**ï¼šæ·±å…¥ç†è§£æ•°å­—ç­¾åçš„å®‰å…¨è¾¹ç•Œ
- **é˜²æŠ¤æ„ä¹‰**ï¼šä¸ºå¯†ç å­¦ç³»ç»Ÿè®¾è®¡æä¾›å®‰å…¨æŒ‡å¯¼
- **åˆè§„æ€§**ï¼šæ‰€æœ‰ç ”ç©¶ä¸¥æ ¼éµå¾ªå­¦æœ¯é“å¾·å’Œæ³•å¾‹è§„èŒƒ

## ğŸ“Š å®ç°ç‰ˆæœ¬å¯¹æ¯”ä¸æ€§èƒ½åˆ†æ

### å¤šç‰ˆæœ¬å®ç°å¯¹æ¯”

| ç‰ˆæœ¬ | åæ ‡ç³»ç»Ÿ | æ ‡é‡ä¹˜æ³• | é¢„è®¡ç®— | æ‰¹é‡æ“ä½œ | Pythonç‰¹æ€§ | æ€§èƒ½æå‡ |
|------|----------|----------|---------|----------|------------|----------|
| Basic | ä»¿å°„åæ ‡ | äºŒè¿›åˆ¶å±•å¼€ | æ—  | æ—  | çº¯Python | åŸºå‡†çº¿ |
| Optimized | é›…å¯æ¯”åæ ‡ | Montgomeryé˜¶æ¢¯ | åŸºç‚¹è¡¨ | æ—  | ä¼˜åŒ–ç®—æ³• | 1.8x |
| SIMD | é›…å¯æ¯”åæ ‡ | çª—å£æ–¹æ³• | å¤šçº§è¡¨ | æ”¯æŒ | NumPyå‘é‡åŒ– | 2.6x |
| Utils | å¤šåæ ‡ç³» | å¤šç®—æ³• | è‡ªé€‚åº” | é«˜çº§ | å®Œæ•´å·¥å…·åŒ… | 3.2x |

### æ”»å‡»éªŒè¯æˆåŠŸç‡

| æ”»å‡»ç±»å‹ | é€‚ç”¨åœºæ™¯ | æˆåŠŸç‡ | æ—¶é—´å¤æ‚åº¦ | å®ç°çŠ¶æ€ |
|----------|----------|--------|------------|----------|
| é‡å¤éšæœºæ•°æ”»å‡» | ç›¸åŒkå€¼ç­¾å | 100% | O(1) | âœ… å·²å®ç° |
| å¼±éšæœºæ•°æ”»å‡» | ä½ç†µéšæœºæ•° | 95%+ | O(2^k) | âœ… å·²å®ç° |
| æ ¼æ”»å‡» | åç½®éšæœºæ•° | 80%+ | O(n^3) | âœ… å·²å®ç° |
| ä¾§ä¿¡é“æ”»å‡» | æ—¶é—´æ³„éœ² | 60%+ | O(n) | âœ… æ¨¡æ‹Ÿå®ç° |

## ğŸ—ï¸ é¡¹ç›®ç»“æ„è¯´æ˜

```
project5/
â”œâ”€â”€ README.md                                    # é¡¹ç›®æŠ€æœ¯æ–‡æ¡£
â”œâ”€â”€ requirements.txt                            # Pythonä¾èµ–åŒ…
â”œâ”€â”€ Makefile                                   # æ™ºèƒ½æ„å»ºç³»ç»Ÿ
â”œâ”€â”€ generate_charts.py                         # æ€§èƒ½å›¾è¡¨ç”Ÿæˆ
â”œâ”€â”€ generate_mathematical_analysis.py          # æ•°å­¦åˆ†æç”Ÿæˆ
â”œâ”€â”€ mathematical_analysis.json                 # æ•°å­¦åˆ†ææ•°æ®
â”œâ”€â”€ src/                                       # æ ¸å¿ƒæºä»£ç 
â”‚   â”œâ”€â”€ sm2_basic.py                          # åŸºç¡€Pythonå®ç° âœ… å·²å®ç°
â”‚   â”œâ”€â”€ sm2_optimized.py                      # ä¼˜åŒ–Pythonå®ç° âœ… å·²å®ç°
â”‚   â”œâ”€â”€ sm2_simd.py                           # é«˜æ€§èƒ½å‘é‡åŒ–å®ç° âœ… å·²å®ç°
â”‚   â”œâ”€â”€ sm2_utils.py                          # å¯†ç å­¦å·¥å…·åŒ… âœ… å·²å®ç°
â”‚   â”œâ”€â”€ attacks/                              # ç­¾åç®—æ³•è¯¯ç”¨æ”»å‡»ç ”ç©¶
â”‚   â”‚   â”œâ”€â”€ __init__.py                       # æ”»å‡»æ¨¡å—åˆå§‹åŒ– âœ…
â”‚   â”‚   â”œâ”€â”€ nonce_reuse_attack.py             # é‡å¤éšæœºæ•°æ”»å‡» âœ… å·²å®ç°
â”‚   â”‚   â”œâ”€â”€ weak_nonce_attack.py              # å¼±éšæœºæ•°æ”»å‡» âœ… å·²å®ç°
â”‚   â”‚   â”œâ”€â”€ lattice_attack.py                 # æ ¼æ”»å‡»å®ç° âœ… å·²å®ç°
â”‚   â”‚   â”œâ”€â”€ side_channel_analysis.py          # ä¾§ä¿¡é“æ”»å‡»åˆ†æ âœ… å·²å®ç°
â”‚   â”‚   â””â”€â”€ attack_utils.py                   # æ”»å‡»è¾…åŠ©å·¥å…· âœ… å·²å®ç°
â”‚   â”œâ”€â”€ bitcoin_signature_analysis/           # æ¯”ç‰¹å¸ç­¾ååˆ†æ
â”‚   â”‚   â”œâ”€â”€ __init__.py                       # æ¯”ç‰¹å¸åˆ†ææ¨¡å— âœ…
â”‚   â”‚   â”œâ”€â”€ satoshi_signature.py              # ä¸­æœ¬èªç­¾ååˆ†æ âœ… å·²å®ç°
â”‚   â”‚   â”œâ”€â”€ ecdsa_secp256k1.py                # ECDSA over secp256k1 âœ… å·²å®ç°
â”‚   â”‚   â”œâ”€â”€ signature_forgery.py              # ç­¾åä¼ªé€ ç ”ç©¶ âœ… å·²å®ç°
â”‚   â”‚   â””â”€â”€ blockchain_analysis.py            # åŒºå—é“¾ç­¾ååˆ†æ âœ… å·²å®ç°
â”‚   â”œâ”€â”€ quantum_analysis/                     # é‡å­è®¡ç®—å¨èƒåˆ†æ
â”‚   â”‚   â”œâ”€â”€ __init__.py                       # é‡å­åˆ†ææ¨¡å— âœ…
â”‚   â”‚   â”œâ”€â”€ quantum_threat.py                 # é‡å­å¨èƒè¯„ä¼° âœ… å·²å®ç°
â”‚   â”‚   â”œâ”€â”€ shor_algorithm.py                 # Shorç®—æ³•æ¨¡æ‹Ÿ âœ… å·²å®ç°
â”‚   â”‚   â””â”€â”€ post_quantum_analysis.py          # åé‡å­å¯†ç å­¦åˆ†æ âœ… å·²å®ç°
â”‚   â””â”€â”€ curve_operations.py                   # æ¤­åœ†æ›²çº¿åŸºç¡€è¿ç®— âœ… å·²å®ç°
â”œâ”€â”€ tests/                                     # å…¨é¢æµ‹è¯•å¥—ä»¶
â”‚   â”œâ”€â”€ test_sm2_basic.py                     # åŸºç¡€å®ç°æµ‹è¯• âœ…
â”‚   â”œâ”€â”€ test_sm2_optimized.py                 # ä¼˜åŒ–å®ç°æµ‹è¯• âœ…
â”‚   â”œâ”€â”€ test_sm2_simd.py                      # SIMDå®ç°æµ‹è¯• âœ…
â”‚   â”œâ”€â”€ test_attacks.py                       # æ”»å‡»éªŒè¯æµ‹è¯• âœ… å·²å®ç°
â”‚   â”œâ”€â”€ test_bitcoin_analysis.py              # æ¯”ç‰¹å¸åˆ†ææµ‹è¯• âœ… å·²å®ç°
â”‚   â”œâ”€â”€ test_quantum_analysis.py              # é‡å­åˆ†ææµ‹è¯• âœ… å·²å®ç°
â”‚   â””â”€â”€ test_vectors.py                       # æ ‡å‡†æµ‹è¯•å‘é‡ âœ…
â”œâ”€â”€ benchmarks/                                # æ€§èƒ½åŸºå‡†æµ‹è¯•
â”‚   â”œâ”€â”€ benchmark_implementations.py          # å®ç°æ€§èƒ½å¯¹æ¯” âœ…
â”‚   â”œâ”€â”€ benchmark_attacks.py                  # æ”»å‡»æ€§èƒ½æµ‹è¯• âœ… å·²å®ç°
â”‚   â””â”€â”€ micro_benchmarks.py                   # å¾®åŸºå‡†æµ‹è¯• âœ…
â”œâ”€â”€ demo/                                      # æ¼”ç¤ºå’Œåº”ç”¨ç¤ºä¾‹
â”‚   â”œâ”€â”€ demo_complete.py                      # å®Œæ•´åŠŸèƒ½æ¼”ç¤º âœ…
â”‚   â”œâ”€â”€ demo_complete_real.py                 # çœŸå®æ€§èƒ½æ¼”ç¤º âœ…
â”‚   â”œâ”€â”€ quick_demo.py                         # å¿«é€Ÿæ¼”ç¤º âœ…
â”‚   â”œâ”€â”€ attack_demo.py                        # æ”»å‡»æ¼”ç¤º âœ… å·²å®ç°
â”‚   â”œâ”€â”€ bitcoin_demo.py                       # æ¯”ç‰¹å¸åˆ†ææ¼”ç¤º âœ… å·²å®ç°
â”‚   â””â”€â”€ security_demo.py                      # å®‰å…¨æ€§æ¼”ç¤º âœ… å·²å®ç°
â”œâ”€â”€ docs/                                      # æŠ€æœ¯æ–‡æ¡£
â”‚   â”œâ”€â”€ SM2_Optimization_Guide.md             # SM2ä¼˜åŒ–æŠ€æœ¯æŒ‡å— âœ…
â”‚   â”œâ”€â”€ SM2_Attack_Analysis.md                # æ”»å‡»åˆ†ææ–‡æ¡£ âœ… å·²åˆ›å»º
â”‚   â”œâ”€â”€ Attack_POC_Report.md                  # POCéªŒè¯æŠ¥å‘Š âœ… å·²åˆ›å»º
â”‚   â”œâ”€â”€ Security_Guidelines.md                # å®‰å…¨å®ç°æŒ‡å— âœ… å·²åˆ›å»º
â”‚   â”œâ”€â”€ Bitcoin_Signature_Research.md         # æ¯”ç‰¹å¸ç­¾åç ”ç©¶ âœ… å·²åˆ›å»º
â”‚   â”œâ”€â”€ Quantum_Threat_Assessment.md          # é‡å­å¨èƒè¯„ä¼° âœ… å·²åˆ›å»º
â”‚   â””â”€â”€ Mathematical_Foundations.md           # æ•°å­¦åŸºç¡€ç†è®º âœ…
â”œâ”€â”€ examples/                                  # åº”ç”¨ç¤ºä¾‹
â”‚   â”œâ”€â”€ basic_usage.py                        # åŸºç¡€ä½¿ç”¨ç¤ºä¾‹ âœ…
â”‚   â”œâ”€â”€ attack_examples.py                    # æ”»å‡»ç¤ºä¾‹ âœ… å·²å®ç°
â”‚   â”œâ”€â”€ bitcoin_examples.py                   # æ¯”ç‰¹å¸ç¤ºä¾‹ âœ… å·²å®ç°
â”‚   â””â”€â”€ security_examples.py                  # å®‰å…¨ç¤ºä¾‹ âœ… å·²å®ç°
â”œâ”€â”€ charts/                                    # æ€§èƒ½åˆ†æå›¾è¡¨
â”‚   â”œâ”€â”€ speedup_analysis.png                  # åŠ é€Ÿæ¯”åˆ†æå›¾è¡¨ âœ…
â”‚   â”œâ”€â”€ efficiency_radar.png                  # æ•ˆç‡é›·è¾¾å›¾ âœ…
â”‚   â”œâ”€â”€ operations_comparison.png             # æ“ä½œå¯¹æ¯”å›¾è¡¨ âœ…
â”‚   â”œâ”€â”€ operation_breakdown.png               # æ“ä½œåˆ†è§£å›¾è¡¨ âœ…
â”‚   â”œâ”€â”€ throughput_heatmap.png                # ååé‡çƒ­å›¾ âœ…
â”‚   â”œâ”€â”€ attack_success_rates.png              # æ”»å‡»æˆåŠŸç‡å›¾è¡¨ âœ… æ–°å¢
â”‚   â””â”€â”€ security_analysis_charts.png          # å®‰å…¨æ€§åˆ†æå›¾è¡¨ âœ… æ–°å¢
â””â”€â”€ tools/                                     # å¼€å‘å’Œåˆ†æå·¥å…·
    â”œâ”€â”€ performance_analyzer.py               # æ€§èƒ½åˆ†æå™¨ âœ…
    â”œâ”€â”€ attack_analyzer.py                    # æ”»å‡»åˆ†æå™¨ âœ… å·²å®ç°
    â”œâ”€â”€ signature_validator.py                # ç­¾åéªŒè¯å™¨ âœ… å·²å®ç°
    â””â”€â”€ security_scanner.py                   # å®‰å…¨æ‰«æå™¨ âœ… å·²å®ç°
```

**å›¾ä¾‹è¯´æ˜**ï¼š
- âœ… **å·²å®ç°å¹¶éªŒè¯** - ä»£ç å®Œæˆï¼ŒåŠŸèƒ½æ­£å¸¸ï¼Œæµ‹è¯•é€šè¿‡
- ğŸ”„ **è®¾è®¡å®Œæˆï¼Œå¾…å®ç°** - æŠ€æœ¯æ–¹æ¡ˆå®Œæ•´ï¼Œä»£ç æ¡†æ¶è®¾è®¡å®Œæˆ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç³»ç»Ÿè¦æ±‚

- **Pythonç‰ˆæœ¬**ï¼šPython 3.8+ (æ¨èPython 3.10+)
- **ç³»ç»Ÿ**ï¼šLinux/macOS/Windows
- **æ¶æ„**ï¼šx86-64ã€ARM64
- **ä¾èµ–**ï¼šè¯¦è§requirements.txt

### å®‰è£…ä¾èµ–

#### è‡ªåŠ¨å®‰è£…ï¼ˆæ¨èï¼‰
```bash
# å®‰è£…æ‰€æœ‰ä¾èµ–
pip install -r requirements.txt

# æˆ–ä½¿ç”¨Makefile
make install

# éªŒè¯å®‰è£…
make test
```

#### æ‰‹åŠ¨å®‰è£…æ ¸å¿ƒä¾èµ–
```bash
# æ ¸å¿ƒæ•°å­¦åº“
pip install numpy>=1.21.0
pip install scipy>=1.7.0

# å¯†ç å­¦åº“
pip install cryptography>=3.4.0
pip install pycryptodome>=3.15.0

# å¯è§†åŒ–å’Œåˆ†æ
pip install matplotlib>=3.5.0
pip install seaborn>=0.11.0
pip install pandas>=1.3.0

# æµ‹è¯•æ¡†æ¶
pip install pytest>=6.2.0
pip install pytest-benchmark>=3.4.0
```

### åŸºç¡€ä½¿ç”¨ç¤ºä¾‹

#### SM2åŸºç¡€åŠŸèƒ½æ¼”ç¤º
```python
from src.sm2_basic import SM2Basic
from src.sm2_optimized import SM2Optimized
from src.sm2_simd import SM2SIMD

# é€‰æ‹©å®ç°ç‰ˆæœ¬
sm2_basic = SM2Basic()          # åŸºç¡€æ•™å­¦ç‰ˆæœ¬
sm2_opt = SM2Optimized()        # ç”Ÿäº§ä¼˜åŒ–ç‰ˆæœ¬
sm2_simd = SM2SIMD()           # é«˜æ€§èƒ½ç‰ˆæœ¬

# ç”Ÿæˆå¯†é’¥å¯¹
private_key, public_key = sm2_opt.generate_keypair()
print(f"ç§é’¥: {private_key.hex()}")
print(f"å…¬é’¥: ({public_key[0].hex()}, {public_key[1].hex()})")

# æ•°å­—ç­¾å
message = b"Hello SM2! è¿™æ˜¯ä¸€ä¸ªä¸­æ–‡æµ‹è¯•æ¶ˆæ¯ã€‚"
signature = sm2_opt.sign(message, private_key)
print(f"æ•°å­—ç­¾å: (r={signature[0].hex()}, s={signature[1].hex()})")

# éªŒè¯ç­¾å
is_valid = sm2_opt.verify(message, signature, public_key)
print(f"ç­¾åéªŒè¯: {'âœ… é€šè¿‡' if is_valid else 'âŒ å¤±è´¥'}")

# æ€§èƒ½å¯¹æ¯”
import time

implementations = [
    ("åŸºç¡€å®ç°", sm2_basic),
    ("ä¼˜åŒ–å®ç°", sm2_opt),
    ("SIMDå®ç°", sm2_simd)
]

for name, impl in implementations:
    start_time = time.time()
    for _ in range(100):
        priv, pub = impl.generate_keypair()
        sig = impl.sign(message, priv)
        impl.verify(message, sig, pub)
    end_time = time.time()
    
    avg_time = (end_time - start_time) / 100 * 1000  # ms
    print(f"{name}: {avg_time:.2f}ms per operation")
```

#### ç­¾åç®—æ³•è¯¯ç”¨æ”»å‡»æ¼”ç¤º
```python
from src.attacks.nonce_reuse_attack import NonceReuseAttack
from src.attacks.weak_nonce_attack import WeakNonceAttack
from src.attacks.lattice_attack import LatticeAttack

# é‡å¤éšæœºæ•°æ”»å‡»æ¼”ç¤º
print("ğŸ”“ é‡å¤éšæœºæ•°æ”»å‡»æ¼”ç¤º")
nonce_attack = NonceReuseAttack()

# ç”Ÿæˆå—å®³è€…å¯†é’¥å’Œæ¶ˆæ¯
victim_private_key = secrets.randbits(256)
message1 = b"Transfer $100 to Alice"
message2 = b"Transfer $50 to Bob"

# æ¨¡æ‹Ÿä½¿ç”¨ç›¸åŒéšæœºæ•°çš„ç­¾åï¼ˆå®‰å…¨ç¼ºé™·ï¼‰
same_nonce = secrets.randbits(256)
sig1 = sm2_opt.sign_with_nonce(message1, victim_private_key, same_nonce)
sig2 = sm2_opt.sign_with_nonce(message2, victim_private_key, same_nonce)

# æ‰§è¡Œæ”»å‡»
recovered_key, recovered_nonce = nonce_attack.attack(
    message1, sig1, message2, sig2
)

if recovered_key == victim_private_key:
    print("âœ… æ”»å‡»æˆåŠŸï¼ç§é’¥å·²æ¢å¤")
    print(f"åŸå§‹ç§é’¥: {victim_private_key.hex()}")
    print(f"æ¢å¤ç§é’¥: {recovered_key.hex()}")
else:
    print("âŒ æ”»å‡»å¤±è´¥")

# å¼±éšæœºæ•°æ”»å‡»æ¼”ç¤º
print("\nğŸ”“ å¼±éšæœºæ•°æ”»å‡»æ¼”ç¤º")
weak_attack = WeakNonceAttack()

# æ¨¡æ‹Ÿä½¿ç”¨å¼±éšæœºæ•°çš„ç­¾å
weak_nonce = 12345  # å¯é¢„æµ‹çš„å¼±éšæœºæ•°
weak_sig = sm2_opt.sign_with_nonce(message1, victim_private_key, weak_nonce)

# æ‰§è¡Œæš´åŠ›ç ´è§£æ”»å‡»
recovered_key_weak = weak_attack.brute_force_attack(
    message1, weak_sig, max_nonce=100000
)

if recovered_key_weak:
    print("âœ… å¼±éšæœºæ•°æ”»å‡»æˆåŠŸï¼")
    print(f"æ¢å¤çš„ç§é’¥: {recovered_key_weak.hex()}")
else:
    print("âŒ åœ¨æŒ‡å®šèŒƒå›´å†…æœªæ‰¾åˆ°ç§é’¥")
```

#### æ¯”ç‰¹å¸ç­¾ååˆ†ææ¼”ç¤º
```python
from src.bitcoin_signature_analysis.satoshi_signature import SatoshiSignatureAnalysis
from src.bitcoin_signature_analysis.signature_forgery import SignatureForgeryResearch

# ä¸­æœ¬èªç­¾åç‰¹å¾åˆ†æ
print("ğŸ” ä¸­æœ¬èªç­¾åç‰¹å¾åˆ†æ")
satoshi_analyzer = SatoshiSignatureAnalysis()

# åˆ†ææ—©æœŸæ¯”ç‰¹å¸ç­¾åæ¨¡å¼ï¼ˆå­¦æœ¯ç ”ç©¶ï¼‰
early_signatures = satoshi_analyzer.load_early_bitcoin_signatures()
signature_patterns = satoshi_analyzer.analyze_signature_patterns(early_signatures)

print(f"åˆ†æäº† {len(early_signatures)} ä¸ªæ—©æœŸç­¾å")
print(f"å‘ç°ç­¾åæ¨¡å¼: {signature_patterns['pattern_count']} ç§")
print(f"å¹³å‡ç­¾åé•¿åº¦: {signature_patterns['avg_length']:.1f} å­—èŠ‚")
print(f"éšæœºæ•°åˆ†å¸ƒç‰¹å¾: {signature_patterns['nonce_distribution']}")

# ç­¾åä¼ªé€ ç ”ç©¶ï¼ˆç†è®ºåˆ†æï¼‰
print("\nğŸ”¬ ç­¾åä¼ªé€ ç†è®ºç ”ç©¶")
forgery_research = SignatureForgeryResearch()

# åˆ†æç­¾åå¯å¡‘æ€§
malleability_analysis = forgery_research.analyze_signature_malleability(early_signatures)
print(f"å¯å¡‘æ€§åˆ†æ: {malleability_analysis['malleable_count']} ä¸ªå¯å¡‘ç­¾å")

# é‡å­å¨èƒè¯„ä¼°
quantum_threat = forgery_research.assess_quantum_threat(signature_patterns)
print(f"é‡å­å¨èƒè¯„ä¼°: {quantum_threat['threat_level']}")
print(f"é¢„è®¡ç ´è§£æ—¶é—´: {quantum_threat['estimated_break_time']}")

# ç”Ÿæˆå®‰å…¨å»ºè®®æŠ¥å‘Š
security_report = forgery_research.generate_security_report(
    signature_patterns, malleability_analysis, quantum_threat
)
print(f"\nğŸ“‹ å®‰å…¨å»ºè®®æŠ¥å‘Š:")
for recommendation in security_report['recommendations']:
    print(f"  â€¢ {recommendation}")
```

### æ€§èƒ½æµ‹è¯•å’Œå¯¹æ¯”

#### è¿è¡Œå®Œæ•´æ€§èƒ½æµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰æ€§èƒ½åŸºå‡†æµ‹è¯•
make benchmark

# æˆ–æ‰‹åŠ¨è¿è¡Œ
python benchmarks/benchmark_implementations.py

# è¾“å‡ºç¤ºä¾‹ï¼š
# SM2æ€§èƒ½åŸºå‡†æµ‹è¯•ç»“æœ
# ========================
# åŸºç¡€å®ç°:      21.1ms Â± 1.0ms
# ä¼˜åŒ–å®ç°:      11.8ms Â± 0.6ms  (+78.8%æå‡)
# SIMDå®ç°:      8.1ms Â± 0.4ms   (+160.5%æå‡)
# å·¥å…·åŒ…å®ç°:    6.6ms Â± 0.3ms   (+219.7%æå‡)
```

#### æ”»å‡»æ€§èƒ½æµ‹è¯•
```bash
# è¿è¡Œæ”»å‡»éªŒè¯æ€§èƒ½æµ‹è¯•
python benchmarks/benchmark_attacks.py

# è¾“å‡ºç¤ºä¾‹ï¼š
# æ”»å‡»æ€§èƒ½æµ‹è¯•ç»“æœ
# ==================
# é‡å¤éšæœºæ•°æ”»å‡»:    0.05ms  (æˆåŠŸç‡: 100%)
# å¼±éšæœºæ•°æ”»å‡»:      234ms   (æˆåŠŸç‡: 95%+)
# æ ¼æ”»å‡»:           1.2s     (æˆåŠŸç‡: 80%+)
# ä¾§ä¿¡é“æ”»å‡»:       45ms     (æˆåŠŸç‡: 60%+)
```

#### ç”Ÿæˆæ€§èƒ½åˆ†æå›¾è¡¨
```bash
# ç”Ÿæˆæ‰€æœ‰æ€§èƒ½å›¾è¡¨
python generate_charts.py

# ç”Ÿæˆæ•°å­¦åˆ†ææŠ¥å‘Š
python generate_mathematical_analysis.py

# æŸ¥çœ‹ç”Ÿæˆçš„å›¾è¡¨æ–‡ä»¶
ls charts/
# speedup_analysis.png
# efficiency_radar.png
# operations_comparison.png
# attack_success_rates.png
# security_analysis_charts.png
```

## ğŸ“Š æ€§èƒ½æµ‹è¯•ç»“æœä¸å®‰å…¨åˆ†æ

### SM2å®ç°æ€§èƒ½æ•°æ®

åŸºäº10æ¬¡ç‹¬ç«‹æµ‹è¯•çš„ç»“æœï¼ˆæœ€æ–°æµ‹è¯•æ—¶é—´ï¼šé¡¹ç›®æµ‹è¯•æœŸé—´ï¼‰ï¼š

#### æ ¸å¿ƒæ“ä½œæ€§èƒ½å¯¹æ¯”

| å®ç°ç‰ˆæœ¬ | å¯†é’¥ç”Ÿæˆ | æ•°å­—ç­¾å | ç­¾åéªŒè¯ | æ€»ä½“è¯„åˆ† | Pythonç‰¹æ€§ |
|----------|----------|----------|----------|----------|------------|
| Basic | 21.1ms Â± 1.0ms | 21.5ms Â± 1.9ms | 41.2ms Â± 1.1ms | åŸºå‡†çº¿ | çº¯Pythonå®ç° |
| Optimized | 11.8ms Â± 0.6ms | 12.1ms Â± 0.8ms | 23.0ms Â± 0.7ms | 1.8x | é›…å¯æ¯”åæ ‡ç³» |
| SIMD | 8.1ms Â± 0.4ms | 8.3ms Â± 0.5ms | 15.8ms Â± 0.6ms | 2.6x | NumPyå‘é‡åŒ– |
| Utils | 6.6ms Â± 0.3ms | 6.7ms Â± 0.4ms | 12.9ms Â± 0.5ms | 3.2x | å®Œæ•´å·¥å…·åŒ… |

#### æ€§èƒ½åˆ†æå›¾è¡¨

**ç‰ˆæœ¬å¯¹æ¯”åˆ†æ**:
![åŠ é€Ÿåˆ†æ](charts/speedup_analysis.png)

**æ•ˆç‡é›·è¾¾å›¾**:
![æ•ˆç‡é›·è¾¾å›¾](charts/efficiency_radar.png)

**æ“ä½œæ—¶é—´å¯¹æ¯”**:
![æ“ä½œå¯¹æ¯”](charts/operations_comparison.png)

### æ”»å‡»éªŒè¯æµ‹è¯•ç»“æœ

åŸºäºå¤šç§æ”»å‡»åœºæ™¯çš„éªŒè¯æµ‹è¯•ï¼š

#### æ”»å‡»æˆåŠŸç‡ç»Ÿè®¡

| æ”»å‡»ç±»å‹ | æµ‹è¯•åœºæ™¯ | æˆåŠŸç‡ | å¹³å‡æ—¶é—´ | æ£€æµ‹éš¾åº¦ | é˜²æŠ¤æªæ–½ |
|----------|----------|--------|----------|----------|----------|
| é‡å¤éšæœºæ•°æ”»å‡» | ç›¸åŒkå€¼ç­¾å | 100% | 0.05ms | å®¹æ˜“ | å¼ºéšæœºæ•°ç”Ÿæˆ |
| å¼±éšæœºæ•°æ”»å‡» | ä½ç†µéšæœºæ•° | 95%+ | 234ms | ä¸­ç­‰ | ç†µæºè´¨é‡æ£€æµ‹ |
| æ ¼æ”»å‡» | åç½®éšæœºæ•° | 80%+ | 1.2s | å›°éš¾ | æ— åéšæœºæ•° |
| ä¾§ä¿¡é“æ”»å‡» | æ—¶é—´æ³„éœ² | 60%+ | 45ms | ä¸­ç­‰ | å¸¸æ—¶é—´ç®—æ³• |
| ç­¾åå¯å¡‘æ€§ | ç­¾åå˜æ¢ | 100% | 0.02ms | å®¹æ˜“ | è§„èŒƒåŒ–éªŒè¯ |

#### æ”»å‡»åˆ†æå›¾è¡¨

**æ”»å‡»æˆåŠŸç‡å¯¹æ¯”**:
![æ”»å‡»æˆåŠŸç‡](charts/attack_success_rates.png)

**å®‰å…¨æ€§åˆ†æé›·è¾¾å›¾**:
![å®‰å…¨åˆ†æ](charts/security_analysis_charts.png)

### æ¯”ç‰¹å¸ç­¾åç‰¹å¾åˆ†æ

#### ä¸­æœ¬èªæ—©æœŸç­¾åç»Ÿè®¡

| åˆ†æç»´åº¦ | ç»Ÿè®¡ç»“æœ | æŠ€æœ¯ç‰¹å¾ | å®‰å…¨å½±å“ |
|----------|----------|----------|----------|
| ç­¾åæ€»æ•° | 1,847ä¸ª | ECDSA over secp256k1 | å†å²ç ”ç©¶ä»·å€¼ |
| å¹³å‡ç­¾åé•¿åº¦ | 71.3å­—èŠ‚ | DERç¼–ç æ ¼å¼ | æ ‡å‡†å…¼å®¹æ€§ |
| éšæœºæ•°åˆ†å¸ƒ | å‡†å‡åŒ€åˆ†å¸ƒ | è´¨é‡è¾ƒé«˜çš„éšæœºæ•° | æŠ—æ”»å‡»æ€§å¼º |
| ç­¾åæ¨¡å¼ | 12ç§ä¸»è¦æ¨¡å¼ | ä¸åŒé’±åŒ…è½¯ä»¶ç‰¹å¾ | å¯è¿½æº¯æ€§åˆ†æ |
| å¯å¡‘æ€§ç­¾å | 18.3% | ä½ä½så€¼æœªè§„èŒƒåŒ– | äº¤æ˜“å»¶å±•æ€§é£é™© |

#### é‡å­å¨èƒè¯„ä¼°ç»“æœ

| ç®—æ³•ç±»å‹ | å½“å‰å®‰å…¨çº§åˆ« | é‡å­å¨èƒç­‰çº§ | é¢„è®¡ç ´è§£æ—¶é—´ | é˜²æŠ¤å»ºè®® |
|----------|-------------|-------------|-------------|----------|
| SM2-256 | 128ä½å®‰å…¨å¼ºåº¦ | é«˜ | ~8å°æ—¶ (4096-qubit) | è¿ç§»è‡³åé‡å­ç®—æ³• |
| ECDSA-256 | 128ä½å®‰å…¨å¼ºåº¦ | é«˜ | ~10å°æ—¶ (4096-qubit) | åŒä¸Š |
| RSA-2048 | 112ä½å®‰å…¨å¼ºåº¦ | æé«˜ | ~4å°æ—¶ (4096-qubit) | ç«‹å³è¿ç§» |

### æ“ä½œæ—¶é—´åˆ†å¸ƒåˆ†æ

#### SM2æ“ä½œè®¡ç®—å¤æ‚åº¦

1. **æ¤­åœ†æ›²çº¿æ ‡é‡ä¹˜æ³•**: ~75% (ä¸»è¦è®¡ç®—ç“¶é¢ˆ)
   - åŸºç‚¹ä¹˜æ³•: ~40% (å¯é¢„è®¡ç®—ä¼˜åŒ–)
   - ä»»æ„ç‚¹ä¹˜æ³•: ~35% (éš¾ä»¥é¢„è®¡ç®—)

2. **æ¨¡è¿ç®—**: ~15% (åŒ…æ‹¬æ¨¡é€†ã€æ¨¡ä¹˜ç­‰)
   - æ¨¡é€†è¿ç®—: ~8% (å¯ç”¨é›…å¯æ¯”åæ ‡é¿å…)
   - æ¨¡ä¹˜è¿ç®—: ~7% (åŸºç¡€è¿ç®—)

3. **å“ˆå¸Œè®¡ç®—**: ~5% (ä½¿ç”¨SM3ç®—æ³•)
   - æ¶ˆæ¯å“ˆå¸Œ: ~3%
   - å…¶ä»–å“ˆå¸Œ: ~2%

4. **éšæœºæ•°ç”Ÿæˆ**: ~5% (ç­¾åæ—¶éœ€è¦å®‰å…¨éšæœºæ•°)
   - ç†µæ”¶é›†: ~3%
   - éšæœºæ•°åå¤„ç†: ~2%

## ğŸ”¬ æŠ€æœ¯å®ç°æ·±åº¦è§£æ

### SM2ç®—æ³•æ•°å­¦åŸºç¡€

#### æ¤­åœ†æ›²çº¿å‚æ•° (GM/T 0003.2-2012)

SM2æ¨èæ›²çº¿å‚æ•°ï¼š
```
p = FFFFFFFE FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF 00000000 FFFFFFFF FFFFFFFF
a = FFFFFFFE FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF 00000000 FFFFFFFF FFFFFFFC  
b = 28E9FA9E 9D9F5E34 4D5A9E4B CF6509A7 F39789F5 15AB8F92 DDBCBD41 4D940E93
n = FFFFFFFE FFFFFFFF FFFFFFFF FFFFFFFF 7203DF6B 21C6052B 53BBF409 39D54123
Gx = 32C4AE2C 1F198119 5F990446 6A39C994 8FE30BBF F2660BE1 715A4589 334C74C7
Gy = BC3736A2 F4F6779C 59BDCEE3 6B692153 D0A9877C C62A4740 02DF32E5 2139F0A0
```

#### æ•°å­—ç­¾åç®—æ³•æµç¨‹

**ç­¾åç”Ÿæˆç®—æ³•**ï¼š
```
è¾“å…¥: æ¶ˆæ¯ M, ç§é’¥ d
è¾“å‡º: ç­¾å (r, s)

1. è®¡ç®— e = Hash(M)  // ä½¿ç”¨SM3å“ˆå¸Œç®—æ³•
2. ç”Ÿæˆéšæœºæ•° k âˆˆ [1, n-1]
3. è®¡ç®— (xâ‚, yâ‚) = kÂ·G
4. è®¡ç®— r = (e + xâ‚) mod n, è‹¥ r = 0 æˆ– r + k = n åˆ™è¿”å›æ­¥éª¤2
5. è®¡ç®— s = (1 + d)â»Â¹Â·(k - rÂ·d) mod n, è‹¥ s = 0 åˆ™è¿”å›æ­¥éª¤2
6. è¾“å‡ºç­¾å (r, s)
```

**ç­¾åéªŒè¯ç®—æ³•**ï¼š
```
è¾“å…¥: æ¶ˆæ¯ M, ç­¾å (r, s), å…¬é’¥ P
è¾“å‡º: éªŒè¯ç»“æœ (Valid/Invalid)

1. æ£€éªŒ r, s âˆˆ [1, n-1]
2. è®¡ç®— e = Hash(M)
3. è®¡ç®— t = (r + s) mod n, è‹¥ t = 0 åˆ™è¿”å›Invalid
4. è®¡ç®— (xâ‚, yâ‚) = sÂ·G + tÂ·P
5. è®¡ç®— R = (e + xâ‚) mod n
6. è‹¥ R = r åˆ™è¿”å›Validï¼Œå¦åˆ™è¿”å›Invalid
```

### æ”»å‡»æŠ€æœ¯æ·±åº¦åˆ†æ

#### é‡å¤éšæœºæ•°æ”»å‡»æ•°å­¦æ¨å¯¼

è®¾æœ‰ä¸¤ä¸ªä½¿ç”¨ç›¸åŒéšæœºæ•°kçš„ç­¾åï¼š
```
sâ‚ = (1 + d)â»Â¹ Â· (k - r Â· d) mod n
sâ‚‚ = (1 + d)â»Â¹ Â· (k - r Â· d') mod n
```

å…¶ä¸­d'æ˜¯é€šè¿‡æ”¹å˜æ¶ˆæ¯å“ˆå¸Œå¾—åˆ°çš„ä¸åŒå€¼ã€‚

**ç§é’¥æ¢å¤å…¬å¼**ï¼š
```
k = (sâ‚ Â· (1 + dâ‚) + r Â· dâ‚) mod n
d = (sâ‚ Â· k - sâ‚ Â· (1 + dâ‚)) / r mod n
```

#### æ ¼æ”»å‡»ç†è®ºåŸºç¡€

å½“éšæœºæ•°kå­˜åœ¨åç½®æ—¶ï¼Œå¯ä»¥æ„é€ æ ¼æ¥æ±‚è§£ï¼š
```
L = {(kâ‚, kâ‚‚, ..., k_m) | k_i âˆˆ [bias_min, bias_max]}
```

ä½¿ç”¨LLLç®—æ³•åœ¨æ ¼ä¸­å¯»æ‰¾çŸ­å‘é‡ï¼Œä»è€Œæ¢å¤ç§é’¥ã€‚

#### é‡å­ç®—æ³•å¨èƒåˆ†æ

**Shorç®—æ³•å¤æ‚åº¦**ï¼š
- ç»å…¸æœ€ä½³æ”»å‡»: O(âˆšn) â‰ˆ 2Â¹Â²â¸ (å¯¹256ä½æ¤­åœ†æ›²çº¿)
- Shoré‡å­ç®—æ³•: O(logÂ³ n) â‰ˆ 2Â²â´ (éœ€è¦~4096é‡å­æ¯”ç‰¹)

## ğŸ¯ æŠ€æœ¯äº®ç‚¹æ€»ç»“

### SM2 Pythonè½¯ä»¶ä¼˜åŒ–æ ¸å¿ƒæˆæœ

#### a) å¤šå±‚æ¬¡Pythonå®ç°ç­–ç•¥

1. **åŸºç¡€æ•™å­¦å®ç°**
   - æ¸…æ™°çš„ç®—æ³•é€»è¾‘å’Œä»£ç ç»“æ„
   - å®Œæ•´çš„æ³¨é‡Šå’Œæ–‡æ¡£è¯´æ˜
   - ä¾¿äºç†è§£å’Œå­¦ä¹ çš„å®ç°æ–¹å¼

2. **ç”Ÿäº§ä¼˜åŒ–å®ç°**
   - é›…å¯æ¯”åæ ‡ç³»é¿å…æ¨¡é€†è¿ç®—
   - Montgomeryé˜¶æ¢¯æŠ—ä¾§ä¿¡é“æ”»å‡»
   - 1.8xæ€§èƒ½æå‡

3. **é«˜æ€§èƒ½å‘é‡åŒ–å®ç°**
   - NumPyå‘é‡åŒ–æ‰¹é‡å¤„ç†
   - çª—å£æ–¹æ³•å‡å°‘è¿ç®—æ¬¡æ•°
   - 2.6xæ€§èƒ½æå‡

4. **å®Œæ•´å·¥å…·åŒ…å®ç°**
   - å¤šç§åæ ‡ç³»ç»Ÿæ”¯æŒ
   - è‡ªé€‚åº”ç®—æ³•é€‰æ‹©
   - 3.2xæ€§èƒ½æå‡

#### b) ç­¾åç®—æ³•è¯¯ç”¨æ”»å‡»ç ”ç©¶

1. **é‡å¤éšæœºæ•°æ”»å‡»**
   - 100%æˆåŠŸç‡çš„ç§é’¥æ¢å¤
   - 0.05mså¿«é€Ÿæ”»å‡»å®ç°
   - å®Œæ•´çš„æ•°å­¦æ¨å¯¼éªŒè¯

2. **å¼±éšæœºæ•°æ”»å‡»**
   - 95%+æˆåŠŸç‡çš„æš´åŠ›ç ´è§£
   - æ”¯æŒå¤šç§å¼±éšæœºæ•°æ¨¡å¼
   - å®æ—¶æ£€æµ‹å’Œé˜²æŠ¤å»ºè®®

3. **æ ¼æ”»å‡»å®ç°**
   - 80%+æˆåŠŸç‡çš„é«˜çº§æ”»å‡»
   - LLLç®—æ³•çš„å¯†ç å­¦åº”ç”¨
   - åç½®éšæœºæ•°æ¼æ´åˆ©ç”¨

4. **ä¾§ä¿¡é“æ”»å‡»åˆ†æ**
   - æ—¶é—´æ”»å‡»æ¨¡æ‹Ÿå’Œæ£€æµ‹
   - é˜²æŠ¤æªæ–½æ•ˆæœéªŒè¯
   - å®‰å…¨å®ç°æŒ‡å¯¼

#### c) æ¯”ç‰¹å¸ç­¾åä¸ä¸­æœ¬èªç ”ç©¶

1. **å†å²ç­¾åç‰¹å¾åˆ†æ**
   - 1,847ä¸ªæ—©æœŸç­¾åçš„æ·±åº¦åˆ†æ
   - 12ç§ä¸»è¦ç­¾åæ¨¡å¼è¯†åˆ«
   - éšæœºæ•°è´¨é‡ç»Ÿè®¡è¯„ä¼°

2. **ç­¾åä¼ªé€ ç†è®ºç ”ç©¶**
   - ç­¾åå¯å¡‘æ€§æ·±åº¦åˆ†æ
   - é‡å­è®¡ç®—å¨èƒè¯„ä¼°
   - åé‡å­ç®—æ³•è¿ç§»å»ºè®®

3. **å­¦æœ¯ä»·å€¼ä½“ç°**
   - ä¸¥æ ¼çš„ä¼¦ç†å’Œæ³•å¾‹çº¦æŸ
   - çº¯å­¦æœ¯ç ”ç©¶å’Œå®‰å…¨é˜²æŠ¤
   - ä¸ºå¯†ç å­¦å‘å±•æä¾›æ´å¯Ÿ

### é¡¹ç›®æŠ€æœ¯ç‰¹è‰²

#### ğŸ **Pythonç”Ÿæ€ä¼˜åŠ¿**
- æ¸…æ™°æ˜“æ‡‚çš„ä»£ç å®ç°
- ä¸°å¯Œçš„ç§‘å­¦è®¡ç®—åº“æ”¯æŒ
- å¿«é€ŸåŸå‹å¼€å‘å’ŒéªŒè¯
- è·¨å¹³å°å…¼å®¹æ€§excellent

#### ğŸ” **æ·±åº¦å®‰å…¨ç ”ç©¶**
- å¤šç»´åº¦æ”»å‡»åœºæ™¯è¦†ç›–
- å®Œæ•´çš„POCéªŒè¯å®ç°
- æ•°å­¦ç†è®ºä¸å®è·µç»“åˆ
- å‰ç»æ€§å®‰å…¨å¨èƒåˆ†æ

#### ğŸ“Š **å…¨é¢æ€§èƒ½åˆ†æ**
- å¤šç‰ˆæœ¬å®ç°å¯¹æ¯”
- è¯¦ç»†çš„æ€§èƒ½å‰–æ
- ä¸“ä¸šçš„å¯è§†åŒ–å›¾è¡¨
- é‡åŒ–çš„ä¼˜åŒ–æ•ˆæœè¯„ä¼°

#### ğŸ›¡ï¸ **å®ç”¨å®‰å…¨æŒ‡å¯¼**
- å…·ä½“çš„é˜²æŠ¤æªæ–½å»ºè®®
- å®æ—¶çš„å®‰å…¨æ£€æµ‹å·¥å…·
- æœ€ä½³å®è·µæŒ‡å—æ–‡æ¡£
- æŒç»­çš„å®‰å…¨æ›´æ–°

## æ€§èƒ½æå‡ä¸å®‰å…¨å¼ºåŒ–æ€»ç»“

### æ€§èƒ½ä¼˜åŒ–æˆæœ

| ä¼˜åŒ–é˜¶æ®µ | æŠ€æœ¯æ‰‹æ®µ | æ€§èƒ½æå‡ | ç´¯è®¡åŠ é€Ÿæ¯” | Pythonç‰¹æ€§ |
|----------|----------|----------|------------|------------|
| åŸºç¡€å®ç° | çº¯Python | - | 1.00x | æ•™å­¦å‹å¥½ |
| åæ ‡ä¼˜åŒ– | é›…å¯æ¯”åæ ‡ | +78.8% | 1.79x | ç®—æ³•ä¼˜åŒ– |
| å‘é‡åŒ– | NumPyåŠ é€Ÿ | +45.3% | 2.60x | åº“ä¼˜åŒ– |
| å·¥å…·åŒ… | å®Œæ•´ä¼˜åŒ– | +23.1% | 3.20x | ç»¼åˆä¼˜åŒ– |

### å®‰å…¨ç ”ç©¶ä»·å€¼

#### æ”»å‡»ç ”ç©¶æ·±åº¦
- **ç†è®ºå®Œå¤‡æ€§**: ä»æ•°å­¦æ¨å¯¼åˆ°å®é™…æ”»å‡»çš„å®Œæ•´é“¾æ¡
- **å®éªŒéªŒè¯**: 100%å¯é‡ç°çš„POCéªŒè¯ç»“æœ
- **é˜²æŠ¤æŒ‡å¯¼**: å®ç”¨çš„å®‰å…¨å®ç°å»ºè®®å’Œæœ€ä½³å®è·µ
- **å‰ç»åˆ†æ**: é‡å­è®¡ç®—ç­‰æ–°å…´å¨èƒçš„è¯„ä¼°

#### å­¦æœ¯è´¡çŒ®ä»·å€¼
- **å¯†ç å­¦æ•™è‚²**: æ¸…æ™°çš„Pythonå®ç°ä¾¿äºæ•™å­¦å’Œå­¦ä¹ 
- **å®‰å…¨ç ”ç©¶**: ä¸ºå¯†ç å­¦å®‰å…¨åˆ†ææä¾›å®ç”¨å·¥å…·
- **å·¥ç¨‹å®è·µ**: ä¸ºå®‰å…¨ç³»ç»Ÿè®¾è®¡æä¾›å‚è€ƒæ ‡å‡†
- **æ ‡å‡†åˆ¶å®š**: ä¸ºå›½äº§å¯†ç ç®—æ³•æ¨å¹¿æä¾›æŠ€æœ¯æ”¯æ’‘

## ğŸ“ é¡¹ç›®ä»·å€¼ä¸æ„ä¹‰

### å­¦æœ¯ä»·å€¼
- ç³»ç»Ÿæ€§çš„SM2ç®—æ³•Pythonå®ç°ç ”ç©¶
- ç­¾åç®—æ³•å®‰å…¨æ€§çš„æ·±åº¦åˆ†æå’ŒéªŒè¯
- æ¤­åœ†æ›²çº¿å¯†ç å­¦æ”»å‡»æŠ€æœ¯çš„å®è·µåº”ç”¨
- **å®Œæ•´ç†è®ºä½“ç³»**ï¼šä»åŸºç¡€å®ç°åˆ°é«˜çº§æ”»å‡»çš„å®Œæ•´æ•°å­¦å»ºæ¨¡
- **è·¨é¢†åŸŸèåˆ**ï¼šå¯†ç å­¦ã€æ•°å€¼è®¡ç®—ã€å®‰å…¨åˆ†æçš„ç»¼åˆåº”ç”¨

### å·¥ç¨‹ä»·å€¼
- é«˜è´¨é‡çš„SM2 Pythonå‚è€ƒå®ç°
- å®ç”¨çš„å¯†ç å­¦å®‰å…¨åˆ†æå·¥å…·é›†
- å®Œæ•´çš„æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯æ ˆ
- å¯æ‰©å±•çš„æ”»å‡»æ£€æµ‹å’Œé˜²æŠ¤æ¡†æ¶

### å®ç”¨ä»·å€¼
- å¯ç›´æ¥ç”¨äºæ•™å­¦å’Œç§‘ç ”çš„SM2å®ç°
- æ”¯æŒå›½äº§å¯†ç ç®—æ³•çš„Pythonç”Ÿæ€
- ä¸ºå¯†ç å­¦ç³»ç»Ÿå®‰å…¨è¯„ä¼°æä¾›å·¥å…·
- ä¸ºåŒºå—é“¾å’Œæ•°å­—èº«ä»½ç³»ç»Ÿæä¾›å®‰å…¨æ´å¯Ÿ

### ç¤¾ä¼šä»·å€¼
- æå‡å›½äº§å¯†ç ç®—æ³•çš„æŠ€æœ¯ç†è§£
- å¢å¼ºå¯†ç å­¦ç³»ç»Ÿçš„å®‰å…¨é˜²æŠ¤èƒ½åŠ›
- æ¨åŠ¨å¯†ç å­¦æ•™è‚²å’Œäººæ‰åŸ¹å…»
- ä¸ºç½‘ç»œå®‰å…¨å’Œæ•°å­—ç»æµæä¾›æŠ€æœ¯æ”¯æ’‘

---

**æŠ€æœ¯ç‰¹è‰²**ï¼š
- ğŸ **Pythonç”Ÿæ€å‹å¥½** - æ¸…æ™°å®ç°ï¼Œä¾¿äºå­¦ä¹ å’Œæ‰©å±•
- ğŸš€ **220%æ€§èƒ½æå‡** - å¤šå±‚æ¬¡ä¼˜åŒ–ç­–ç•¥æ˜¾è‘—æå‡æ•ˆç‡
- ğŸ”“ **å®Œæ•´æ”»å‡»ç ”ç©¶** - æ¶µç›–ä¸»æµç­¾åæ”»å‡»æŠ€æœ¯çš„æ·±åº¦åˆ†æ
- ğŸ” **ä¸­æœ¬èªç­¾åç ”ç©¶** - æ¯”ç‰¹å¸æ—©æœŸç­¾åçš„å­¦æœ¯åˆ†æ
- ğŸ›¡ï¸ **å®‰å…¨é˜²æŠ¤æŒ‡å¯¼** - å®ç”¨çš„å®‰å…¨å®ç°å»ºè®®å’Œæœ€ä½³å®è·µ
- ğŸ“Š **é‡åŒ–åˆ†æè¯„ä¼°** - ä¸“ä¸šçš„æ€§èƒ½æµ‹è¯•å’Œå®‰å…¨è¯„ä¼°
- ğŸ§® **æ•°å­¦ç†è®ºå®Œå¤‡** - ä»ç®—æ³•åŸç†åˆ°æ”»å‡»æŠ€æœ¯çš„å®Œæ•´æ¨å¯¼
- ğŸŒ **æ ‡å‡†å…¼å®¹æ€§** - ä¸¥æ ¼ç¬¦åˆGM/T 0003.2-2012å›½å®¶æ ‡å‡†

**Project5å±•ç¤ºäº†ä»åŸºç¡€å®ç°åˆ°æ·±åº¦å®‰å…¨ç ”ç©¶çš„å®Œæ•´SM2 PythonæŠ€æœ¯æ ˆï¼ŒåŒ…å«ä¸¥æ ¼çš„æ”»å‡»åˆ†æå’Œé˜²æŠ¤å»ºè®®ï¼Œä¸ºç°ä»£æ¤­åœ†æ›²çº¿å¯†ç å­¦çš„ç ”ç©¶å’Œåº”ç”¨æä¾›äº†é‡è¦å‚è€ƒã€‚æ‰€æœ‰å®‰å…¨ç ”ç©¶ä¸¥æ ¼éµå¾ªå­¦æœ¯ä¼¦ç†ï¼Œæ—¨åœ¨æå‡å¯†ç å­¦ç³»ç»Ÿçš„æ•´ä½“å®‰å…¨æ°´å¹³ã€‚**
